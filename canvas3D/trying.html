<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title></title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    body {
      background: #111;
    }
  </style>
</head>
<body>

<script src="js/lib/three.min.js"></script>
<script src="js/lib/OrbitControls.js"></script>
<script src="js/core.js"></script>
<script src="js/setup.js"></script>

<script type="text/javascript">

// (function(window) {
//   'use strict';
  var core = window.core;
  var T = window.THREE;

  core.init();
  core.addGround();

  // lights
  var ambientLight = new T.AmbientLight(0xffffff, 0.5);
  scene.add(ambientLight);

  var light = new T.DirectionalLight(0xffffff, 1);
  light.color.setHSL(0.1, 1, 0.95);
  light.position.set(0, 20, -10);
  light.position.multiplyScalar(40);

  scene.add(light);

  // put all of the demo related stuff here

  // amount of elements in freq array - use to create shapes
  var totalEls = 192;
  // could this be a function
  // var grid = {
  //   xDistrib: 8,
  //   yDistrib: 4,
  //   zDistrib: 6,
  //   xOffset: 
  // }
  var shapes = [];

  for (var i=0; i<totalEls; i++) {
    var cube = core.build(
      'BoxGeometry', [5, 5, 5],
      'MeshPhongMaterial', [{
        color: 0xff0000,
        shading: T.SmoothShading,
        specular: 0xffffff,
        shininess: 60,
      }]
    );
    cube.position.set(
      // x = i%amount-half total width
      ((i%8)*10)-(4*10),
      // y = i%amount needed to make yDistrib - half total height
      (Math.floor((i%8)/8)*10),
      // z = i%amount needed to make zDistrib - half total depth
      ( Math.floor(i/32)*10 ) );
    cube.material.color.setHSL(i/50,0.8,0.6);
    scene.add(cube);
    shapes.push(cube); 
  }
  

  // var bobDirection = "up";

  // render loop
  var draw = function() {

    var frequencies = adjustFreqData(totalEls);
    var newData = frequencies.newFreqs;

    for(var i=0;i<newData.length;i++) {
      var d = newData[i];
      var s = shapes[i];

      s.rotation.x += d/2550;
      s.rotation.y += d/2550;

      // s.position.y -= d/125;
      // s.position.x -= d/125;

      s.scale.set( (5*d/2550)+1, (5*d/2550)+1, (5*d/2550)+1 );

    }

    // camera.position.set

    // cube.rotation.x += 0.01;
    // cube.rotation.y += 0.01;
    // // Bobbing up and down
    // if (bobDirection == "up") {
    //   cube.position.y += 0.25;
    //   if (cube.position.y >= 20) {
    //     bobDirection = "down";
    //   }
    // } else {
    //   cube.position.y -= 0.125;
    //   if (cube.position.y <= 1) {
    //     bobDirection = "up";
    //   }
    // }


    controls.update();
    renderer.render(scene, camera);
    requestAnimationFrame(draw);
  };

  // Kick it off
  // update();
// }(window));

</script>
</body>
</html>
